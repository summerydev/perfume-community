<template>
  <div>
    <ul
      class="infinite-list"
      v-infinite-scroll="load"
      style="overflow: auto"
      v-for="perfume in perfumesReviews"
      :key="perfume.id"
    >
      <li v-if="perfume.cnt_review > 0">
        <el-card
          shadow="hover"
          style="border-radius: 10px"
          :body-style="{ padding: '15px' }"
        >
          <div>
            <span class="perfume_name">{{ perfume.perfume_name }}</span>
            <span class="brand">({{ perfume.brand_name }})</span>
          </div>
          <div>
            <span class="recommendation"
              >üëç
              {{ perfume.recommendation[1] ? perfume.recommendation[1] : 0 }}
              ({{
                perfume.recommendation[1]
                  ? (perfume.recommendation[1] / perfume.cnt_review) * 100
                  : 0
              }}%, {{ perfume.cnt_review }}Í∞ú Î¶¨Î∑∞)
            </span>
          </div>
          <div class="img-box">
            <img v-bind:src="perfume.path" alt="perfume image" class="image" />
          </div>
          <div>
            <el-row>ÏßÄÏÜçÎ†•</el-row>
            <el-row
              type="flex"
              v-for="(el, index) in perfume.longevity"
              :key="index"
            >
              <el-col :span="14">
                <el-progress
                  :stroke-width="10"
                  :percentage="(el / perfume.cnt_review) * 100"
                ></el-progress>
              </el-col>
              <el-col :span="10">{{ longevityMessage[index] }}</el-col>
            </el-row>
          </div>
          <div>
            <el-row>ÌôïÏÇ∞Î†•</el-row>
            <el-row
              type="flex"
              v-for="(el, index) in perfume.strength"
              :key="index"
            >
              <el-col :span="14">
                <el-progress
                  :stroke-width="10"
                  :percentage="(el / perfume.cnt_review) * 100"
                ></el-progress>
              </el-col>
              <el-col :span="10">{{ strengthMessage[index] }}</el-col>
            </el-row>
          </div>
          <div>
            <el-row>Ï∂îÏ≤ú ÏÑ±Î≥Ñ</el-row>
            <el-row
              type="flex"
              v-for="(el, index) in perfume.gender"
              :key="index"
            >
              <el-col :span="14">
                <el-progress
                  :stroke-width="10"
                  :percentage="(el / perfume.cnt_review) * 100"
                ></el-progress>
              </el-col>
              <el-col :span="10">{{ genderMessage[index] }}</el-col>
            </el-row>
          </div>
        </el-card>
      </li>
    </ul>
  </div>
</template>

<script>
import { mapGetters } from "vuex";
import {
  recommendationMessage,
  longevityMessage,
  strengthMessage,
  genderMessage,
  frangranceMessage,
} from "../../config/config.js";
export default {
  data() {
    return {
      recommendationMessage,
      longevityMessage,
      strengthMessage,
      genderMessage,
      frangranceMessage,
      count: 0,
      perfumesReviews: [],
    };
  },
  computed: {
    ...mapGetters({
      reviewList: "getReviewList",
      userInfo: "getUserInfo",
    }),
    reviewLists() {
      return this.reviewList;
    },
  },
  async created() {
    await this.$store.dispatch("fetchDataReviews");
    this.getPerfumeReviews();
  },
  methods: {
    load() {
      this.count += 2;
    },
    async getPerfumeReviews() {
      try {
        const result = await this.$axios.get("/perfumes/reviews");
        this.perfumesReviews = result.data;
        console.log(this.perfumesReviews);
      } catch (e) {
        console.log(e);
      }
    },
  },
};
</script>

<style scoped>
ul {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
}
li {
  list-style: none;
  margin: 10px;
  padding: 10px;
  background-color: white;
  border-radius: 15px;
  width: 350px;
  height: 450px;
}
.el-card {
  width: 350px;
  height: 450px;
}
.overflow div {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.el-row {
  width: 100%;
  display: inline-block;
}

.recommendation {
  font-size: 1.3rem;
  font-weight: bolder;
}
.reviewInfo {
  font-size: 0.8rem;
  color: gray;
}

.perfume_name {
  font-size: 1rem;
  font-weight: bolder;
}

.fragrance {
  width: max-content;
  font-size: 0.8em;
  padding: 2px 7px;
  border-radius: 20px;
  text-align: center;
}

.content {
  padding: 10px;
  height: 40px;
  border-radius: 5px;
  background-color: rgba(0, 0, 0, 0.083);
  overflow-x: auto;
  overflow-y: auto;
}

.img-box {
  text-align: center;
  width: 100px;
  height: 150px;
  margin: 0 auto;
}
.image {
  width: 100%;
  object-fit: cover;
}
</style>
